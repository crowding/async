---
title: "clapping"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{clapping}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(generators)
```

```{r clappers}
ClappingMusic <- function() {

  pattern <- function(gen) {
    for (n in c(3, 2, 1, 2)) {
      for (j in 1:n)
        yield("clap")
      yield(".")
    }
  }

  pat1 <- itertools::irepeat(pattern())
  part1 <-
    gen({
      for (i in 1:13)
        for (j in 1:12)
          for (k in 1:12)
            yield(nextItem(pat))
    })

  pat2 <- itertools::irep(pattern())
  part2 <- gen({
    for (i in 1:13) {
      for (j in 1:12)
        for (k in 1:12)
          yield(nextItem(pat))
      nextItem(pat)
    }
  })

  gen({
    repeat yield(paste(nextItem(part2), nextItem(part1)))
  })
}

```


